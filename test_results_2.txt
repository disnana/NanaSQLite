============================= test session starts =============================
platform win32 -- Python 3.11.9, pytest-8.4.2, pluggy-1.5.0 -- C:\Program Files\Python311\python.exe
cachedir: .pytest_cache
benchmark: 5.1.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)
rootdir: D:\data-backup\code\コード保存\NanaSQLite
configfile: pyproject.toml
plugins: langsmith-0.4.38, asyncio-0.26.0, benchmark-5.1.0, socket-0.7.0, typeguard-4.4.4, anyio-4.9.0
asyncio: mode=Mode.AUTO, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collecting ... collected 8 items

tests/test_security_v120.py::test_sql_validation_strict_mode PASSED      [ 12%]
tests/test_security_v120.py::test_sql_validation_warning_mode PASSED     [ 25%]
tests/test_security_v120.py::test_allowed_sql_functions_init PASSED      [ 37%]
tests/test_security_v120.py::test_allowed_sql_functions_query PASSED     [ 50%]
tests/test_security_v120.py::test_forbidden_sql_functions PASSED         [ 62%]
tests/test_security_v120.py::test_override_allowed PASSED                [ 75%]
tests/test_security_v120.py::test_redos_protection PASSED                [ 87%]
tests/test_security_v120.py::test_connection_closed_error FAILED         [100%]
tests/test_security_v120.py::test_connection_closed_error ERROR          [100%]

=================================== ERRORS ====================================
______________ ERROR at teardown of test_connection_closed_error ______________
tests\test_security_v120.py:15: in teardown_module
    os.remove(DB_PATH)
E   PermissionError: [WinError 32] プロセスはファイルにアクセスできません。別のプロセスが使用中です。: 'test_security.db'
================================== FAILURES ===================================
________________________ test_connection_closed_error _________________________
tests\test_security_v120.py:118: in test_connection_closed_error
    child = db.table("slave")
            ^^^^^^^^^^^^^^^^^
src\nanasqlite\core.py:1936: in table
    self._child_instances.add(child)
C:\Program Files\Python311\Lib\_weakrefset.py:88: in add
    self.data.add(ref(item, self._remove))
E   TypeError: unhashable type: 'NanaSQLite'
=========================== short test summary info ===========================
FAILED tests/test_security_v120.py::test_connection_closed_error - TypeError:...
ERROR tests/test_security_v120.py::test_connection_closed_error - PermissionE...
==================== 1 failed, 7 passed, 1 error in 0.38s =====================
