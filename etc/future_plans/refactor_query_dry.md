# 将来の計画: クエリメソッドの重複排除 (DRY)

## 概要
`AsyncNanaSQLite.query` と `AsyncNanaSQLite.query_with_pagination` は、現在多くのロジック（バリデーション、SQL構築、カラム名抽出など）が重複しています。これを共通のプライベートメソッドに抽出することで、保守性を向上させ、バグの混入を防ぎます。

## 提案されている改善案
`_build_select_sql` のような内部メソッドを作成し、以下の責務を統合する：
1.  バリデーション（where, order_by, group_by, columns）
2.  識別子のサニタイズ
3.  SQL文の構築（LIMIT/OFFSET/GROUP BY の有無を動的に判断）
4.  カラム名の解決（エイリアスの考慮など）

## 保留した理由
- 現在の実装は安定して動作しており、大規模なリファクタリングによる予期せぬ退行（リグレッション）のリスクを避けるため。
- 差し当たり重要度の高い機能的な修正（セキュリティ、プール堅牢化）に注力するため。

## 次のステップ
- 非同期APIの機能追加が一段落したタイミングで、同期版（`core.py`）のリファクタリングと合わせて実施を検討する。
